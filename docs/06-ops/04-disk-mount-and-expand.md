

æ–°åˆ›å»º EC2 å®ä¾‹åï¼Œç³»ç»Ÿåªæœ‰é»˜è®¤ä¸€ä¸ª 8G çš„ç¡¬ç›˜ï¼Œå¤§éƒ¨åˆ†åœºæ™¯ä¸‹æ˜¯ä¸å¤Ÿç”¨çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬æœ‰æ­å»ºæ•°æ®åº“çš„éœ€æ±‚ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ç”³è¯·ä¸€å¼ ç›˜ï¼ŒæŒ‚è½½åˆ° `/data` è·¯å¾„ä¸‹ã€‚

# é‡å¯åç£ç›˜é‡æ–°æŒ‚è½½



ä¸€èˆ¬æ•°æ®åº“ç›®å½• ä½äº /data ä¸‹ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å•ç‹¬çš„ç£ç›˜è¿›è¡ŒæŒ‚è½½ã€‚å½“æœåŠ¡å™¨è¿›è¡Œé‡å¯æ—¶ï¼Œç£ç›˜ä¸ä¼šè‡ªåŠ¨æŒ‚è½½ï¼Œæ‰€ä»¥ï¼Œé‡å¯åï¼Œæˆ‘ä»¬åº”è¯¥æ‰‹åŠ¨å¯¹æ•°æ®ç›˜è¿›è¡ŒæŒ‚è½½ã€‚



## æ‰‹åŠ¨æŒ‚è½½

ä½¿ç”¨ `lsblk` å’Œ `mount` å‘½ä»¤æ¥æ£€æŸ¥å’ŒæŒ‚è½½ç£ç›˜ã€‚

```

lsblk
NAME      MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS
xvda      202:0    0   8G  0 disk 
â”œâ”€xvda1   202:1    0   8G  0 part /
â”œâ”€xvda127 259:0    0   1M  0 part 
â””â”€xvda128 259:1    0  10M  0 part /boot/efi
xvdb      202:16   0  10G  0 disk 


sudo mount /dev/xvdb /data
```



## è‡ªåŠ¨æŒ‚è½½é…ç½®



# ç£ç›˜æ‰©å®¹

## AWS EC2 æ§åˆ¶é¢æ¿ä¿®æ”¹ç£ç›˜å¤§å°

- ä»`AWS Console`è¿›å…¥ EC2é€‰æ‹©è¦æ‰©å®¹çš„ Volume
- é€‰æ‹©éœ€è¦æ‰©å®¹çš„ç£ç›˜ï¼Œç‚¹å‡»`æ“ä½œ`æŒ‰é’®
- ç‚¹å‡»`ä¿®æ”¹`å·
- å·ç±»å‹é€‰æ‹©`é€šç”¨å‹SSD(gp2)`ï¼ˆå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©å…¶ä»–ç±»å‹ï¼‰
- å¤§å°è¾“å…¥`16`ï¼ˆæŒ‰éœ€è¾“å…¥ï¼‰
- ç‚¹å‡»ç¡®è®¤ä¿®æ”¹

![img](https://muyids.oss-cn-beijing.aliyuncs.com/img/v2-817f3a575c7ef5a72d13933aee6b30a2_1440w-20240125163059711.webp)



## æ£€æŸ¥ç£ç›˜æ˜¯å¦çœŸçš„æ‰©å®¹æˆåŠŸ

```
lsblk
```

è¾“å‡ºç¤ºä¾‹ï¼ˆçœ‹ `xvda` ä¸ `xvda1` çš„ Sizeï¼‰ï¼š

```
NAME        MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
xvda        202:0    0   32G  0 disk 
â””â”€xvda1     202:1    0   16G  0 part /
```

å¦‚æœ `xvda` æ˜¾ç¤ºä¸º 32Gã€ä½† `xvda1` è¿˜æ˜¯ 16Gï¼Œè¯´æ˜ç£ç›˜å·²æ‰©ä½†åˆ†åŒºæ²¡æ‰©ã€‚

## æ‰©å®¹åˆ†åŒº

```
sudo growpart /dev/xvda 1
```

å¦‚æœæˆåŠŸï¼Œä½ ä¼šçœ‹åˆ°æç¤ºç±»ä¼¼ï¼š

```
CHANGED: partition=1 start=2048 old: size=33552384 end=33554432 new: size=41940991 end=41943039
```

## éªŒè¯

æ‰©å±•æ–‡ä»¶ç³»ç»Ÿåï¼Œä½¿ç”¨ **df-h** å‘½ä»¤éªŒè¯æ“ä½œç³»ç»Ÿæ˜¯å¦å¯ä»¥çœ‹åˆ°é¢å¤–çš„ç©ºé—´ï¼š

```
df -h
```





## å¦‚æœæ–‡ä»¶ç³»ç»Ÿè¿˜æ²¡æœ‰æ‰©å±•

------

### âœ… ä¸‹ä¸€æ­¥ï¼šæ‰©å±•æ–‡ä»¶ç³»ç»Ÿ

ä½ åªéœ€è¦å†æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œè®©æ–‡ä»¶ç³»ç»Ÿè¯†åˆ«æ‰©å®¹åçš„ç©ºé—´ã€‚

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ **`xfs` æ–‡ä»¶ç³»ç»Ÿ**ï¼ˆå¤§æ¦‚ç‡æ˜¯ï¼Œå› ä¸º Amazon Linux 2 é»˜è®¤æ˜¯ xfsï¼‰ï¼š

```
sudo xfs_growfs /
```

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ **`ext4` æ–‡ä»¶ç³»ç»Ÿ**ï¼š

```
sudo resize2fs /dev/xvda1
```

------

### âš ï¸ æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿç±»å‹

ä½ å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤ç¡®è®¤ä½¿ç”¨çš„æ˜¯å“ªç§æ–‡ä»¶ç³»ç»Ÿï¼š

```
df -T /
```

è¾“å‡ºç±»ä¼¼ï¼š

```
Filesystem     Type  Size  Used Avail Use% Mounted on
/dev/xvda1     xfs    8G  7.8G  206M  98% /
```

### ğŸš€ æ‰§è¡Œå®Œåå†æŸ¥ï¼š

```
df -h
```



# ç”³è¯·æ–°ç£ç›˜ï¼ŒæŒ‚è½½åˆ°ä¸€ä¸ªç›®å½•ä¸‹

ç³»ç»Ÿé»˜è®¤ä¼šæœ‰ä¸€å—ç›˜

```
$ lsblk
NAME      MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS
xvda      202:0    0   8G  0 disk 
â”œâ”€xvda1   202:1    0   8G  0 part /
â”œâ”€xvda127 259:0    0   1M  0 part 
â””â”€xvda128 259:1    0  10M  0 part /boot/efi
```

## ğŸ¯ æœ€ç»ˆç›®æ ‡ï¼š

æˆ‘ä»¬å¸Œæœ›å¢åŠ ä¸€å—ç›˜ï¼ŒæŒ‚è½½åˆ°`/data`è·¯å¾„ä¸‹ï¼Œæœ€ç»ˆå¸Œæœ›çœ‹åˆ°çš„æ˜¯ï¼š

```
Filesystem      Size  Used Avail Use% Mounted on
/dev/xvda1       32G   15G   17G  47% /
/dev/xvda2       8G  	 ...   ...  ...  /data
```





## ğŸ› ï¸ æ“ä½œæµç¨‹ï¼ˆä»¥å·²æœ‰å‰©ä½™ç©ºé—´ä¸ºä¾‹ï¼‰

ä½ å½“å‰ç£ç›˜ `xvda` æ˜¯ 32Gï¼Œä¸”åˆ†åŒº `xvda1` å æ»¡äº†å…¨éƒ¨ç©ºé—´ã€‚å¦‚æœä½ æƒ³å†æ·»åŠ ä¸€å—ç‹¬ç«‹çš„åˆ†åŒºç”¨äº `/data`ï¼Œé€šå¸¸æ¨èæ–°å»ºä¸€å—ç‹¬ç«‹çš„ EBS ç£ç›˜å¹¶æŒ‚è½½åˆ° `/data`ï¼ˆ**æ¨èã€ç¨³å®šã€å®‰å…¨**ï¼‰

é€‚ç”¨äºï¼šä½ ä¸æƒ³åŠ¨ç°æœ‰ç³»ç»Ÿç›˜ã€ä¸å¸Œæœ›æå¤æ‚åˆ†åŒºæ“ä½œã€‚

## æ­¥éª¤ï¼š

### åˆ›å»ºæ–°å·

ç™»å½• AWS æ§åˆ¶å°ï¼Œè¿›å…¥ EC2 â†’ å·ï¼ˆEBSï¼‰

é€‰æ‹©åŒä¸€å¯ç”¨åŒºï¼ˆæ¯”å¦‚ us-east-1aï¼‰ï¼Œå»ºè®® 10G~100G



### å°†æ–°å·é™„åŠ åˆ°ä½ çš„å®ä¾‹

åœ¨å®ä¾‹ä¸­è¯†åˆ«ç£ç›˜å¹¶æŒ‚è½½ï¼š

![image-20250405145938259](https://muyids.oss-cn-beijing.aliyuncs.com/img/image-20250405145938259.png)

ğŸ–¥ï¸ åœ¨ EC2 ä¸Šæ‰§è¡Œå‘½ä»¤ï¼š

```
# 1. æŸ¥çœ‹ç£ç›˜è®¾å¤‡ï¼ˆæ–°ç£ç›˜å¯èƒ½æ˜¯ /dev/xvdfï¼‰
lsblk

# æ˜¾ç¤ºä¸‹é¢çš„ä¿¡æ¯
NAME      MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS
xvda      202:0    0   8G  0 disk 
â”œâ”€xvda1   202:1    0   8G  0 part /
â”œâ”€xvda127 259:0    0   1M  0 part 
â””â”€xvda128 259:1    0  10M  0 part /boot/efi
xvdb      202:16   0  10G  0 disk 

# 2. å‡è®¾æ˜¯ /dev/xvdbï¼Œåˆ›å»ºåˆ†åŒº
sudo parted /dev/nvme1n1 --script mklabel gpt mkpart primary ext4 0% 100%

# 3. æ ¼å¼åŒ–ä¸º ext4 æ–‡ä»¶ç³»ç»Ÿ
sudo mkfs.ext4 /dev/xvdb

# 4. åˆ›å»ºæŒ‚è½½ç‚¹
sudo mkdir -p /data

# 5. æŒ‚è½½åˆ†åŒº
sudo mount /dev/xvdb /data

# 6. éªŒè¯æŒ‚è½½
df -h /data
```



æœ€ç»ˆæˆ‘ä»¬çš„æœºå™¨ä¸Šæœ‰ä¸¤å—ç£ç›˜ï¼Œé€šè¿‡ `lsblk` å’Œ `df` æŸ¥çœ‹

```
# lsblk
NAME      MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS
xvda      202:0    0  32G  0 disk 
â”œâ”€xvda1   202:1    0  32G  0 part /
â”œâ”€xvda127 259:0    0   1M  0 part 
â””â”€xvda128 259:1    0  10M  0 part /boot/efi
xvdf      202:80   0   8G  0 disk 
â””â”€xvdf1   202:81   0   8G  0 part /data
```



```
# df -h
Filesystem      Size  Used Avail Use% Mounted on
devtmpfs        4.0M     0  4.0M   0% /dev
tmpfs           2.0G     0  2.0G   0% /dev/shm
tmpfs           781M  492K  781M   1% /run
/dev/xvda1      8.0G  2.2G  5.9G  27% /
tmpfs           2.0G     0  2.0G   0% /tmp
/dev/xvda128     10M  1.3M  8.7M  13% /boot/efi
tmpfs           391M     0  391M   0% /run/user/1000
/dev/xvdb       9.8G   24K  9.3G   1% /data
```





# æ‰©å®¹ `/data` çš„æ–¹æ³•

1. **ç¡®è®¤æ–‡ä»¶ç³»ç»Ÿç±»å‹**

   ```
   df -Th /data
   ```
   
   - å¦‚æœæ˜¯ `ext4`ï¼šç”¨ `resize2fs`
   - å¦‚æœæ˜¯ `xfs`ï¼šç”¨ `xfs_growfs`
   
2. **ç›´æ¥æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ**

   - ext4:

     ```
     sudo resize2fs /dev/xvdb
     ```
     
   - xfs:
   
     ```
  sudo xfs_growfs /data
     ```

3. **æ£€æŸ¥ç»“æœ**

   ```
   bash
   
   
   å¤åˆ¶ç¼–è¾‘
   df -h /data
   ```

------

ğŸ’¡ å°ç»“ï¼š
 ä½ çš„ `/data` æ˜¯ç›´æ¥æ ¼å¼åŒ–åˆ°æ•´ä¸ª `/dev/xvdb` ç£ç›˜ä¸Šçš„ï¼Œæ‰€ä»¥ä¸éœ€è¦åˆ†åŒºæ‰©å®¹ï¼Œåªè¦æ‰©æ–‡ä»¶ç³»ç»Ÿå³å¯ã€‚
